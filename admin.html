<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" href="/favicon.png" type="image/png">
  <meta charset="UTF-8" />
  <title>Admin – Wholesale eBay Products</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #0f172a;
      color: #e5e7eb;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    .wrap {
      max-width: 980px;
      width: 100%;
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.4fr);
      gap: 18px;
    }
    @media (max-width: 860px) {
      .wrap { grid-template-columns: 1fr; }
    }
    .card {
      background: #020617;
      border-radius: 16px;
      padding: 20px 20px 22px;
      border: 1px solid #1f2937;
      box-shadow: 0 18px 45px rgba(0,0,0,0.6);
    }
    h1 {
      font-size: 1.4rem;
      margin-bottom: 6px;
    }
    h2 {
      font-size: 1.05rem;
      margin-top: 14px;
      margin-bottom: 6px;
    }
    p {
      font-size: 0.9rem;
      color: #cbd5f5;
      margin-bottom: 6px;
    }
    code {
      background: #020617;
      border: 1px solid #1e293b;
      padding: 2px 4px;
      border-radius: 4px;
      font-size: 0.8rem;
    }
    a {
      color: #38bdf8;
      text-decoration: none;
      word-break: break-all;
    }
    a:hover { text-decoration: underline; }
    ul {
      margin-left: 18px;
      margin-bottom: 6px;
      font-size: 0.9rem;
      color: #e5e7eb;
    }
    .label {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #9ca3af;
      margin-top: 10px;
    }
    .box {
      background: #020617;
      border-radius: 8px;
      padding: 6px 8px;
      font-size: 0.85rem;
      border: 1px solid #1f2937;
      margin-top: 4px;
    }
    .pill {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid #4b5563;
      font-size: 0.75rem;
      color: #e5e7eb;
      margin-right: 4px;
      margin-top: 2px;
    }
    form label {
      display: block;
      font-size: 0.82rem;
      margin-bottom: 3px;
      color: #cbd5f5;
    }
    form input,
    form textarea,
    form select {
      width: 100%;
      font-size: 0.82rem;
      padding: 6px 8px;
      border-radius: 8px;
      border: 1px solid #1f2937;
      background: #020617;
      color: #e5e7eb;
      outline: none;
      margin-bottom: 8px;
    }
    form textarea {
      resize: vertical;
      min-height: 70px;
    }
    form input:focus,
    form textarea:focus,
    form select:focus {
      border-color: #38bdf8;
      box-shadow: 0 0 0 1px rgba(56,189,248,0.3);
    }
    .form-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 8px;
    }
    .btn-primary {
      display: inline-block;
      padding: 8px 16px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      font-size: 0.86rem;
      font-weight: 600;
      background: #3b82f6;
      color: #f9fafb;
      margin-top: 4px;
    }
    .btn-primary:hover {
      background: #2563eb;
    }
    .small-text {
      font-size: 0.78rem;
      color: #9ca3af;
      margin-top: 4px;
    }
    .section-title {
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #9ca3af;
      margin-bottom: 4px;
    }

    /* Login overlay */
    .login-wrap {
      max-width: 360px;
      width: 100%;
    }
    .login-title {
      font-size: 1.3rem;
      margin-bottom: 8px;
    }
    .login-error {
      font-size: 0.8rem;
      color: #f97373;
      margin-bottom: 6px;
      display: none;
    }
    .row-inline {
      display: flex;
      gap: 6px;
      align-items: center;
    }
    .row-inline input {
      margin-bottom: 0;
    }
    .helper-btn {
      border-radius: 999px;
      border: 1px solid #4b5563;
      padding: 6px 10px;
      font-size: 0.78rem;
      background: #020617;
      color: #e5e7eb;
      cursor: pointer;
      white-space: nowrap;
    }
    .helper-btn:hover {
      background: #111827;
    }
  </style>
</head>
<body>
  <!-- Login View -->
  <div id="loginView" class="login-wrap" style="display:none;">
    <div class="card">
      <h1 class="login-title">Admin Login</h1>
      <p>Enter your admin password to manage products.</p>
      <form id="loginForm" onsubmit="return handleLogin(event);">
        <label for="admin_password">Password</label>
        <input
          type="password"
          id="admin_password"
          autocomplete="current-password"
          placeholder="Enter admin password"
          required
        />
        <div id="loginError" class="login-error">Incorrect password. Try again.</div>
        <button type="submit" class="btn-primary">Unlock Admin</button>
        <div class="small-text" style="margin-top:8px;">
          You can change this password directly in <code>admin.html</code>.
        </div>
      </form>
    </div>
  </div>

  <!-- Admin Content -->
  <div id="adminContent" class="wrap" style="display:none;">
    <!-- LEFT: Info / Links -->
    <div class="card">
      <h1>Admin Panel – Wholesale eBay Products</h1>
      <p>This page is just for you. Sellers will not see this.</p>

      <h2>Contact Email</h2>
      <p>
        Primary contact for sellers and approvals:<br />
        <strong>watchzapnsave@gmail.com</strong>
      </p>

      <h2>Google Sheets</h2>

      <p class="label">Applications Sheet</p>
      <div class="box">
        All seller applications are stored here:<br /><br />
        <a href="https://docs.google.com/spreadsheets/d/1EmyVj4waoPIqeK-EgrUmPtJklsIV7ePGHR7PmU_uQU4/edit#gid=0" target="_blank" rel="noopener">
          Applications – Wholesale eBay Products
        </a>
      </div>

      <p class="label">Products Sheet</p>
      <div class="box">
        All products that appear on <code>products.html</code> come from this tab:<br /><br />
        <a href="https://docs.google.com/spreadsheets/d/1EmyVj4waoPIqeK-EgrUmPtJklsIV7ePGHR7PmU_uQU4/edit#gid=790653222" target="_blank" rel="noopener">
          Products – Wholesale eBay Products
        </a>
      </div>

      <h2>Image workflow (simple)</h2>
      <ul>
        <li>Upload product photos into your Drive folder for images.</li>
        <li>Right-click the image → <strong>Get link</strong> → set to “Anyone with link”.</li>
        <li>Paste that link into the form on the right and click “Convert to direct URL”.</li>
      </ul>
      <p class="small-text">
        The converted link goes into the <code>image_url</code> column and is used on the public products page.
      </p>
    </div>

    <!-- RIGHT: Add Product Form -->
    <div class="card">
      <div class="section-title">Add Product to Google Sheet</div>
      <h2>New Product Form</h2>
      <p>
        Use this form to add products to your <strong>Products</strong> sheet. You can paste a normal Drive share link
        and convert it into a direct image URL.
      </p>

      <!-- Using your dedicated Products Web App URL -->
      <form
        method="POST"
        action="https://script.google.com/macros/s/AKfycbxh3di1ajR0pTj8NWTWflhiAuSvpp-ap2IcpEh9IUFAHIn98U9XrKxgo7thZ-OtUurdUQ/exec"
      >
        <input type="hidden" name="return_url" value="https://ogdeig.github.io/Wholesale-eBay-Products/admin.html" />

        <div class="form-row">
          <div>
            <label for="product_id">Product ID (optional)</label>
            <input
              type="text"
              id="product_id"
              name="product_id"
              placeholder="P001, P002, etc."
            />
          </div>
          <div>
            <label for="product_type">Product Type *</label>
            <select id="product_type" name="product_type" required>
              <option value="">Select one</option>
              <option value="Digital">Digital</option>
              <option value="Physical">Physical</option>
            </select>
          </div>
        </div>

        <label for="product_name">Full Product Name *</label>
        <input
          type="text"
          id="product_name"
          name="product_name"
          placeholder="Pro Office Software License (Digital)"
          required
        />

        <label for="short_name">Short Name (for cards)</label>
        <input
          type="text"
          id="short_name"
          name="short_name"
          placeholder="Pro Office License"
        />

        <div class="form-row">
          <div>
            <label for="category">Category</label>
            <input
              type="text"
              id="category"
              name="category"
              placeholder="Software, PC Accessories, Home & Office..."
            />
          </div>
        </div>

        <!-- Image URL + helper -->
        <label for="image_url">Image URL (Drive direct link)</label>
        <div class="row-inline">
          <input
            type="url"
            id="image_url"
            name="image_url"
            placeholder="https://drive.google.com/uc?export=view&id=FILE_ID"
          />
          <button type="button" class="helper-btn" onclick="convertDriveLink()">
            Convert from share link
          </button>
        </div>
        <div class="small-text">
          Paste a Drive link like <code>https://drive.google.com/file/d/FILE_ID/view?usp=sharing</code> and click
          “Convert from share link”. It will be turned into a direct image URL for you.
        </div>

        <div class="form-row" style="margin-top:8px;">
          <div>
            <label for="reseller_price_usd">Reseller Price (USD) *</label>
            <input
              type="number"
              step="0.01"
              id="reseller_price_usd"
              name="reseller_price_usd"
              placeholder="24.00"
              required
            />
          </div>
          <div>
            <label for="suggested_min_price_usd">Suggested eBay Min (USD)</label>
            <input
              type="number"
              step="0.01"
              id="suggested_min_price_usd"
              name="suggested_min_price_usd"
              placeholder="34.00"
            />
          </div>
          <div>
            <label for="suggested_max_price_usd">Suggested eBay Max (USD)</label>
            <input
              type="number"
              step="0.01"
              id="suggested_max_price_usd"
              name="suggested_max_price_usd"
              placeholder="39.00"
            />
          </div>
        </div>

        <div class="form-row">
          <div>
            <label for="is_featured">Featured?</label>
            <select id="is_featured" name="is_featured">
              <option value="FALSE">No</option>
              <option value="TRUE">Yes</option>
            </select>
          </div>
          <div>
            <label for="active">Active? *</label>
            <select id="active" name="active" required>
              <option value="TRUE" selected>Yes (show on site)</option>
              <option value="FALSE">No (hide on site)</option>
            </select>
          </div>
        </div>

        <label for="notes">Notes (internal only)</label>
        <textarea
          id="notes"
          name="notes"
          placeholder="Any variations, bundle notes, or special instructions for this product."
        ></textarea>

        <button type="submit" class="btn-primary">Add Product to Sheet</button>
        <div class="small-text">
          After submitting, this product will appear as a new row in the
          <strong>Products</strong> sheet and on
          <code>products.html</code> (if Active = TRUE).
        </div>
      </form>
    </div>
  </div>

  <script>
    // === SIMPLE PASSWORD PROTECTION ===
    // Change this password by editing the string below:
    const ADMIN_PASSWORD = "ChangeThisPassword123"; // <--- EDIT THIS

    function showAdmin() {
      document.getElementById("loginView").style.display = "none";
      document.getElementById("adminContent").style.display = "grid";
    }

    function showLogin() {
      document.getElementById("loginView").style.display = "block";
      document.getElementById("adminContent").style.display = "none";
    }

    function handleLogin(event) {
      event.preventDefault();
      const input = document.getElementById("admin_password").value.trim();
      const error = document.getElementById("loginError");

      if (input === ADMIN_PASSWORD) {
        localStorage.setItem("wep_admin_authed", "true");
        error.style.display = "none";
        showAdmin();
        return false;
      } else {
        error.style.display = "block";
        return false;
      }
    }

    // On load, auto-unlock if previously authenticated in this browser
    (function initAdmin() {
      const authed = localStorage.getItem("wep_admin_authed") === "true";
      if (authed) {
        showAdmin();
      } else {
        showLogin();
      }
    })();

    // === Drive link helper ===
    function convertDriveLink() {
      const input = document.getElementById("image_url");
      const raw = input.value.trim();
      if (!raw) return;

      // Try to extract FILE_ID from typical Drive share URLs
      // Examples:
      // https://drive.google.com/file/d/FILE_ID/view?usp=sharing
      // https://drive.google.com/open?id=FILE_ID
      let fileId = "";

      // pattern 1: /file/d/FILE_ID/
      const m1 = raw.match(/\/file\/d\/([^/]+)\//);
      if (m1 && m1[1]) {
        fileId = m1[1];
      } else {
        // pattern 2: ?id=FILE_ID
        const m2 = raw.match(/[?&]id=([^&]+)/);
        if (m2 && m2[1]) {
          fileId = m2[1];
        }
      }

      if (!fileId) {
        alert("Could not find a file ID in that link. Paste a normal Drive share link.");
        return;
      }

      const direct = "https://drive.google.com/uc?export=view&id=" + fileId;
      input.value = direct;
    }
  </script>
</body>
</html>
