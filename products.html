<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Products – Wholesale eBay Products</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Browse the wholesale eBay products available for approved sellers, with reseller pricing and suggested eBay price ranges." />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: #111827;
      background: #f3f4f6;
      line-height: 1.6;
      font-size: 16px;
    }
    a { color: #2563eb; text-decoration: none; }
    a:hover { text-decoration: underline; }

    header {
      background: linear-gradient(135deg, #0f172a, #1f2937);
      color: #f9fafb;
      padding: 20px 20px 22px;
    }
    .container {
      max-width: 1080px;
      margin: 0 auto;
    }
    .nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }
    .logo {
      font-weight: 700;
      font-size: 1.1rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }
    .nav-links a {
      color: #e5e7eb;
      margin-left: 16px;
      font-size: 0.9rem;
    }
    .nav-links a:hover { color: #ffffff; }

    .page-title {
      margin-top: 8px;
      margin-bottom: 4px;
      font-size: 1.6rem;
    }
    .page-subtitle {
      font-size: 0.94rem;
      color: #e5e7eb;
      max-width: 720px;
    }

    main {
      padding: 24px 20px 40px;
    }
    section {
      margin-bottom: 24px;
      background: #ffffff;
      border-radius: 16px;
      padding: 18px 18px 20px;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.06);
    }
    section h2 {
      font-size: 1.25rem;
      margin-bottom: 8px;
      color: #111827;
    }
    section p {
      margin-bottom: 8px;
      font-size: 0.92rem;
      color: #374151;
    }

    .filters-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      margin: 10px 0 4px;
      font-size: 0.86rem;
    }
    .filter-label {
      font-weight: 600;
      color: #4b5563;
    }
    .filter-select,
    .filter-input {
      font-size: 0.86rem;
      padding: 6px 9px;
      border-radius: 999px;
      border: 1px solid #d1d5db;
      outline: none;
      background: #f9fafb;
    }
    .filter-select:focus,
    .filter-input:focus {
      border-color: #2563eb;
      box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.2);
    }

    .products-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
      gap: 14px;
      margin-top: 12px;
    }
    .product-card {
      background: #f9fafb;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      padding: 12px 12px 14px;
      display: flex;
      flex-direction: column;
    }
    .product-image-wrap {
      background: #e5e7eb;
      border-radius: 10px;
      padding: 8px;
      margin-bottom: 8px;
      min-height: 120px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.78rem;
      color: #6b7280;
      text-align: center;
    }
    .product-image-wrap img {
      max-width: 100%;
      max-height: 140px;
      object-fit: contain;
      border-radius: 8px;
      display: block;
    }
    .product-title {
      font-weight: 600;
      font-size: 0.95rem;
      margin-bottom: 2px;
      color: #111827;
    }
    .product-meta {
      font-size: 0.8rem;
      color: #6b7280;
      margin-bottom: 6px;
    }
    .product-price-row {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      font-size: 0.88rem;
      margin-bottom: 6px;
      gap: 6px;
      flex-wrap: wrap;
    }
    .product-price-label {
      font-size: 0.75rem;
      color: #6b7280;
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }
    .product-price {
      font-weight: 700;
      color: #047857;
    }
    .product-profit {
      font-size: 0.8rem;
      color: #4b5563;
    }
    .product-footer {
      margin-top: auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
    }
    .product-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
    }
    .product-tag {
      font-size: 0.72rem;
      padding: 3px 8px;
      border-radius: 999px;
      background: #ecfdf5;
      color: #047857;
      border: 1px solid #bbf7d0;
    }
    .product-id {
      font-size: 0.72rem;
      color: #9ca3af;
    }

    .status-message {
      font-size: 0.86rem;
      color: #6b7280;
      margin-top: 6px;
    }
    .status-message.error {
      color: #b91c1c;
    }

    .small-text {
      font-size: 0.8rem;
      color: #6b7280;
      margin-top: 6px;
    }

    footer {
      padding: 18px 20px 22px;
      font-size: 0.8rem;
      color: #6b7280;
      text-align: center;
    }
    footer a {
      color: #4b5563;
      margin: 0 6px;
      font-size: 0.8rem;
    }
    footer a:hover { color: #111827; }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <nav class="nav">
        <div class="logo">Wholesale eBay Products</div>
        <div class="nav-links">
          <a href="index.html">Home</a>
          <a href="index.html#how-it-works">How it works</a>
          <a href="products.html">All products</a>
          <a href="index.html#apply">Apply</a>
        </div>
      </nav>
      <h1 class="page-title">Product Catalog for Approved Sellers</h1>
      <p class="page-subtitle">
        This page shows the products available in our wholesale program, along with reseller pricing and suggested
        eBay price ranges. Final availability and details are always confirmed in your personal product package.
      </p>
    </div>
  </header>

  <main>
    <div class="container">
      <section>
        <h2>All Products</h2>
        <p>
          Products shown here come directly from our internal Google Sheet. Items marked as inactive in the sheet
          won’t appear here. Highlighted products may change over time as demand shifts.
        </p>

        <div class="filters-row">
          <span class="filter-label">Filter:</span>
          <select id="categoryFilter" class="filter-select">
            <option value="">All categories</option>
          </select>
          <select id="typeFilter" class="filter-select">
            <option value="">All types</option>
            <option value="Digital">Digital</option>
            <option value="Physical">Physical</option>
          </select>
          <input
            id="searchInput"
            class="filter-input"
            type="text"
            placeholder="Search by name or ID..."
          />
        </div>

        <div id="statusMessage" class="status-message">Loading products from Google Sheets…</div>

        <div id="productsGrid" class="products-grid">
          <!-- Products will be injected here by JavaScript -->
        </div>

        <div class="small-text">
          Note: Reseller pricing and suggested price ranges are subject to change. Always refer to the
          most recent product package we email you for final numbers.
        </div>
      </section>
    </div>
  </main>

  <footer>
    <div style="margin-bottom:6px;">
      &copy; 2025 Wholesale eBay Products. All rights reserved.
    </div>
    <div>
      <a href="#">Terms</a> ·
      <a href="#">Privacy</a>
    </div>
    <div style="margin-top:6px;">
      Wholesale eBay Products is an independent supplier and is not affiliated with or endorsed by eBay or any product brand owners.
    </div>
  </footer>

  <script>
    // ====== CONFIG: Your existing spreadsheet & Products tab ======
    // This is the same sheet file you're using already:
    const SHEET_ID = "1EmyVj4waoPIqeK-EgrUmPtJklsIV7ePGHR7PmU_uQU4";
    const SHEET_NAME = "Products";

    // Google Visualization API JSON endpoint
    // IMPORTANT: You must "Publish to the web" for this sheet/tab (instructions below).
    const SHEET_URL =
      "https://docs.google.com/spreadsheets/d/" +
      SHEET_ID +
      "/gviz/tq?tqx=out:json&sheet=" +
      encodeURIComponent(SHEET_NAME);

    const productsGrid = document.getElementById("productsGrid");
    const statusMessage = document.getElementById("statusMessage");
    const categoryFilter = document.getElementById("categoryFilter");
    const typeFilter = document.getElementById("typeFilter");
    const searchInput = document.getElementById("searchInput");

    let allProducts = [];

    async function fetchProducts() {
      try {
        const res = await fetch(SHEET_URL);
        const text = await res.text();

        // The response is wrapped like: /*O_o*/ google.visualization.Query.setResponse({...});
        const jsonStr = text.substring(text.indexOf("{"), text.lastIndexOf("}") + 1);
        const data = JSON.parse(jsonStr);

        const cols = data.table.cols.map(c => c.label);
        const rows = data.table.rows;

        allProducts = rows
          .map(row => {
            const obj = {};
            row.c.forEach((cell, idx) => {
              const key = cols[idx];
              obj[key] = cell ? cell.v : "";
            });
            return obj;
          })
          .filter(p => {
            // Only show active products (active == TRUE or "TRUE")
            const activeVal = String(p.active || "").toLowerCase();
            return activeVal === "true" || activeVal === "yes" || activeVal === "1";
          });

        populateCategoryFilter(allProducts);
        renderProducts();
        statusMessage.textContent = allProducts.length
          ? `Showing ${allProducts.length} active products.`
          : "No active products found. Add some rows to your Products sheet.";
      } catch (err) {
        console.error("Error loading products:", err);
        statusMessage.textContent =
          "Could not load products from Google Sheets. Check your publish settings and sheet name.";
        statusMessage.classList.add("error");
      }
    }

    function populateCategoryFilter(products) {
      const categories = new Set();
      products.forEach(p => {
        if (p.category) categories.add(p.category);
      });
      categoryFilter.innerHTML = '<option value="">All categories</option>';
      Array.from(categories)
        .sort()
        .forEach(cat => {
          const opt = document.createElement("option");
          opt.value = cat;
          opt.textContent = cat;
          categoryFilter.appendChild(opt);
        });
    }

    function renderProducts() {
      const categoryVal = categoryFilter.value.toLowerCase();
      const typeVal = typeFilter.value.toLowerCase();
      const searchVal = searchInput.value.trim().toLowerCase();

      const filtered = allProducts.filter(p => {
        const categoryMatch =
          !categoryVal || String(p.category || "").toLowerCase() === categoryVal;

        const typeMatch =
          !typeVal || String(p.product_type || "").toLowerCase() === typeVal.toLowerCase();

        const inName =
          String(p.product_name || "").toLowerCase().includes(searchVal) ||
          String(p.short_name || "").toLowerCase().includes(searchVal) ||
          String(p.product_id || "").toLowerCase().includes(searchVal);

        return categoryMatch && typeMatch && (!searchVal || inName);
      });

      productsGrid.innerHTML = "";

      if (!filtered.length) {
        productsGrid.innerHTML =
          '<div class="status-message">No products match your filters yet.</div>';
        statusMessage.textContent = "No products match current filters.";
        return;
      }

      statusMessage.textContent = `Showing ${filtered.length} product${
        filtered.length === 1 ? "" : "s"
      }.`;

      filtered.forEach(p => {
        const card = document.createElement("article");
        card.className = "product-card";

        // Image block
        const imgWrap = document.createElement("div");
        imgWrap.className = "product-image-wrap";

        if (p.image_url) {
          const img = document.createElement("img");
          img.src = p.image_url;
          img.alt = p.short_name || p.product_name || "Product image";
          imgWrap.appendChild(img);
        } else {
          imgWrap.innerHTML = "Product Image Placeholder";
        }

        // Title & meta
        const title = document.createElement("div");
        title.className = "product-title";
        title.textContent = p.short_name || p.product_name || "Untitled Product";

        const meta = document.createElement("div");
        meta.className = "product-meta";
        meta.textContent = [
          p.category || null,
          p.product_type ? `Type: ${p.product_type}` : null
        ]
          .filter(Boolean)
          .join(" · ");

        // Pricing
        const priceRow = document.createElement("div");
        priceRow.className = "product-price-row";

        const left = document.createElement("div");
        const priceLabel = document.createElement("div");
        priceLabel.className = "product-price-label";
        priceLabel.textContent = "Reseller Price";

        const priceVal = document.createElement("div");
        priceVal.className = "product-price";
        priceVal.textContent = p.reseller_price_usd
          ? `$${Number(p.reseller_price_usd).toFixed(2)}`
          : "TBD";

        left.appendChild(priceLabel);
        left.appendChild(priceVal);

        const profit = document.createElement("div");
        profit.className = "product-profit";

        const minPrice = p.suggested_min_price_usd
          ? `$${Number(p.suggested_min_price_usd).toFixed(2)}`
          : null;
        const maxPrice = p.suggested_max_price_usd
          ? `$${Number(p.suggested_max_price_usd).toFixed(2)}`
          : null;
        const minProfit = p.est_profit_min_usd
          ? `$${Number(p.est_profit_min_usd).toFixed(2)}`
          : null;
        const maxProfit = p.est_profit_max_usd
          ? `$${Number(p.est_profit_max_usd).toFixed(2)}`
          : null;

        const priceRange =
          minPrice && maxPrice ? `Suggested eBay: ${minPrice}–${maxPrice}` : "";
        const profitRange =
          minProfit && maxProfit ? `Est. profit: ${minProfit}–${maxProfit}` : "";

        profit.innerHTML = [priceRange, profitRange].filter(Boolean).join("<br />");

        priceRow.appendChild(left);
        priceRow.appendChild(profit);

        // Footer
        const footer = document.createElement("div");
        footer.className = "product-footer";

        const tagsWrap = document.createElement("div");
        tagsWrap.className = "product-tags";

        const isFeaturedStr = String(p.is_featured || "").toLowerCase();
        if (isFeaturedStr === "true" || isFeaturedStr === "yes" || isFeaturedStr === "1") {
          const tag = document.createElement("span");
          tag.className = "product-tag";
          tag.textContent = "Featured";
          tagsWrap.appendChild(tag);
        }

        if (p.product_type) {
          const tag = document.createElement("span");
          tag.className = "product-tag";
          tag.textContent = p.product_type;
          tagsWrap.appendChild(tag);
        }

        const id = document.createElement("div");
        id.className = "product-id";
        if (p.product_id) {
          id.textContent = `ID: ${p.product_id}`;
        }

        footer.appendChild(tagsWrap);
        footer.appendChild(id);

        card.appendChild(imgWrap);
        card.appendChild(title);
        card.appendChild(meta);
        card.appendChild(priceRow);
        card.appendChild(footer);

        productsGrid.appendChild(card);
      });
    }

    // Filter handlers
    categoryFilter.addEventListener("change", renderProducts);
    typeFilter.addEventListener("change", renderProducts);
    searchInput.addEventListener("input", () => {
      // simple debounce-ish feel, but fast enough for small lists
      renderProducts();
    });

    // Kick things off
    fetchProducts();
  </script>

  <!--
    HOW TO HOOK THIS UP:

    1. In Google Sheets, open:
       Wholesale eBay Products – Applications

    2. Click the "Products" tab (the one with columns:
       product_id, product_name, short_name, category, product_type,
       reseller_price_usd, suggested_min_price_usd, suggested_max_price_usd,
       est_profit_min_usd, est_profit_max_usd, image_url, is_featured, active, notes)

    3. Go to: File → Share → Publish to web…
       - Under "Link", choose: "Entire document" or specifically the "Products" sheet.
       - Format can stay as "Web page".
       - Click "Publish".

       IMPORTANT: For the /gviz API, the sheet usually just needs to be accessible. If you run
       into loading issues, also make sure:
       - File → Share → "Anyone with the link" (Viewer).

    4. You do NOT need to change the SHEET_URL in this file, because it already uses your
       existing sheet ID (1EmyVj4waoPIqeK-EgrUmPtJklsIV7ePGHR7PmU_uQU4) and the "Products" tab.

    5. Add products by filling in rows on the Products sheet and setting:
       - active = TRUE for items you want to show
       - is_featured = TRUE for items you want to highlight visually

    Then refresh:
      https://ogdeig.github.io/Wholesale-eBay-Products/products.html
  -->
</body>
</html>
