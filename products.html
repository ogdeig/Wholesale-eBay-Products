<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" href="/favicon.png" type="image/png">
  <meta charset="UTF-8" />
  <title>Products – Wholesale eBay Products</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Browse the wholesale eBay products available for approved sellers, with reseller pricing and suggested eBay price ranges." />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: #111827;
      background: #f3f4f6;
      line-height: 1.6;
      font-size: 16px;
    }
    a { color: #2563eb; text-decoration: none; }
    a:hover { text-decoration: underline; }

    header {
      background: linear-gradient(135deg, #0f172a, #1f2937);
      color: #f9fafb;
      padding: 20px 20px 22px;
    }
    .container {
      max-width: 1080px;
      margin: 0 auto;
    }
    .nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }
    .logo {
      font-weight: 700;
      font-size: 1.1rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }
    .nav-links a {
      color: #e5e7eb;
      margin-left: 16px;
      font-size: 0.9rem;
    }
    .nav-links a:hover { color: #ffffff; }

    .page-title {
      margin-top: 8px;
      margin-bottom: 4px;
      font-size: 1.6rem;
    }
    .page-subtitle {
      font-size: 0.94rem;
      color: #e5e7eb;
      max-width: 720px;
    }

    main {
      padding: 24px 20px 40px;
    }
    section {
      margin-bottom: 24px;
      background: #ffffff;
      border-radius: 16px;
      padding: 18px 18px 20px;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.06);
    }
    section h2 {
      font-size: 1.25rem;
      margin-bottom: 8px;
      color: #111827;
    }
    section p {
      margin-bottom: 8px;
      font-size: 0.92rem;
      color: #374151;
    }

    .filters-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      margin: 10px 0 4px;
      font-size: 0.86rem;
    }
    .filter-label {
      font-weight: 600;
      color: #4b5563;
    }
    .filter-select,
    .filter-input {
      font-size: 0.86rem;
      padding: 6px 9px;
      border-radius: 999px;
      border: 1px solid #d1d5db;
      outline: none;
      background: #f9fafb;
    }
    .filter-select:focus,
    .filter-input:focus {
      border-color: #2563eb;
      box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.2);
    }

    .products-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
      gap: 14px;
      margin-top: 12px;
    }
    .product-card {
      background: #f9fafb;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      padding: 12px 12px 14px;
      display: flex;
      flex-direction: column;
    }
    .product-image-wrap {
      background: #e5e7eb;
      border-radius: 10px;
      padding: 8px;
      margin-bottom: 8px;
      min-height: 120px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.78rem;
      color: #6b7280;
      text-align: center;
    }
    .product-image-wrap img {
      max-width: 100%;
      max-height: 140px;
      object-fit: contain;
      border-radius: 8px;
      display: block;
    }
    .product-title {
      font-weight: 600;
      font-size: 0.95rem;
      margin-bottom: 2px;
      color: #111827;
    }
    .product-meta {
      font-size: 0.8rem;
      color: #6b7280;
      margin-bottom: 6px;
    }
    .product-price-row {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      font-size: 0.88rem;
      margin-bottom: 6px;
      gap: 6px;
      flex-wrap: wrap;
    }
    .product-price-label {
      font-size: 0.75rem;
      color: #6b7280;
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }
    .product-price {
      font-weight: 700;
      color: #047857;
    }
    .product-shipping-note {
      font-size: 0.72rem;
      color: #6b7280;
      margin-top: 2px;
    }
    .product-profit {
      font-size: 0.95rem;
      font-weight: 700;
      color: #16a34a;
      text-align: right;
    }
    .product-profit span.label {
      display: block;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: #15803d;
      margin-bottom: 2px;
    }
    .product-price-info {
      font-size: 0.78rem;
      color: #6b7280;
      margin-bottom: 4px;
    }
    .product-footer {
      margin-top: auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
    }
    .product-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
    }
    .product-tag {
      font-size: 0.72rem;
      padding: 3px 8px;
      border-radius: 999px;
      background: #ecfdf5;
      color: #047857;
      border: 1px solid #bbf7d0;
    }
    .product-id {
      font-size: 0.72rem;
      color: #9ca3af;
    }

    .status-message {
      font-size: 0.86rem;
      color: #6b7280;
      margin-top: 6px;
    }
    .status-message.error {
      color: #b91c1c;
    }

    .small-text {
      font-size: 0.8rem;
      color: #6b7280;
      margin-top: 6px;
    }

    footer {
      padding: 18px 20px 22px;
      font-size: 0.8rem;
      color: #6b7280;
      text-align: center;
    }
    footer a {
      color: #4b5563;
      margin: 0 6px;
      font-size: 0.8rem;
    }
    footer a:hover { color: #111827; }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <nav class="nav">
        <div class="logo">Wholesale eBay Products</div>
        <div class="nav-links">
          <a href="index.html">Home</a>
          <a href="index.html#how-it-works">How it works</a>
          <a href="products.html">All products</a>
          <a href="index.html#apply">Apply</a>
        </div>
      </nav>
      <h1 class="page-title">Product Catalog for Approved Sellers</h1>
      <p class="page-subtitle">
        This page shows the products available in our wholesale program, along with reseller pricing,
        suggested eBay price ranges, and estimated potential profit ranges.
      </p>
    </div>
  </header>

  <main>
    <div class="container">
      <section>
        <h2>All Products</h2>
        <p>
          Products shown here come directly from our internal Google Sheet. Items marked as inactive in the sheet
          won’t appear here. Highlighted products may change over time as demand shifts.
        </p>

        <div class="filters-row">
          <span class="filter-label">Filter:</span>
          <select id="categoryFilter" class="filter-select">
            <option value="">All categories</option>
          </select>
          <select id="typeFilter" class="filter-select">
            <option value="">All types</option>
            <option value="Digital">Digital</option>
            <option value="Physical">Physical</option>
          </select>
          <input
            id="searchInput"
            class="filter-input"
            type="text"
            placeholder="Search by name or ID..."
          />
        </div>

        <div id="statusMessage" class="status-message">Loading products from Google Sheets…</div>

        <div id="productsGrid" class="products-grid">
          <!-- Products will be injected here by JavaScript -->
        </div>

        <div class="small-text">
          Reseller prices shown include <strong>U.S. shipping</strong> so you know your all-in cost.
          <br />
          <strong>* Potential profit</strong> is an estimate based on suggested eBay prices and typical fees.
          Your actual profit will vary depending on your final selling price, shipping, fees, and returns.
        </div>
      </section>
    </div>
  </main>

  <footer>
    <div style="margin-bottom:6px;">
      &copy; 2025 Wholesale eBay Products. All rights reserved.
    </div>
    <div>
      <a href="terms.html">Terms</a> ·
<a href="policy.html">Privacy & Returns</a>
    </div>
    <div style="margin-top:6px;">
      Wholesale eBay Products is an independent supplier and is not affiliated with or endorsed by eBay or any product brand owners.
    </div>
  </footer>

  <!-- CSV parser -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <script>
    const SHEET_CSV_URL =
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vST7uNhUD6X51DlQd2ZrJETR2AXUljk2K8cqm39K8SLbxoLcFOK0Md57j9xYAjglStlyqIlRkZ1kYod/pub?gid=790653222&single=true&output=csv";

    const productsGrid = document.getElementById("productsGrid");
    const statusMessage = document.getElementById("statusMessage");
    const categoryFilter = document.getElementById("categoryFilter");
    const typeFilter = document.getElementById("typeFilter");
    const searchInput = document.getElementById("searchInput");

    let allProducts = [];

    function normalizeImageUrl(raw) {
      if (!raw) return "";
      const url = String(raw).trim();
      if (!url) return "";

      let fileId = "";
      let m = url.match(/\/file\/d\/([^/]+)/);
      if (m && m[1]) fileId = m[1];

      if (!fileId) {
        m = url.match(/[?&]id=([^&]+)/);
        if (m && m[1]) fileId = m[1];
      }

      if (!fileId) {
        m = url.match(/uc\?export=\w+&id=([^&]+)/);
        if (m && m[1]) fileId = m[1];
      }

      if (fileId) {
        return "https://drive.google.com/uc?export=download&id=" + fileId;
      }
      return url;
    }

    async function fetchProducts() {
      try {
        const res = await fetch(SHEET_CSV_URL);
        const csv = await res.text();

        const parsed = Papa.parse(csv, {
          header: true,
          skipEmptyLines: true
        });

        allProducts = (parsed.data || [])
          .map(row => row)
          .filter(p => {
            const activeVal = String(p.active || "").toLowerCase().trim();
            return activeVal === "true" || activeVal === "yes" || activeVal === "1";
          });

        populateCategoryFilter(allProducts);
        renderProducts();
        statusMessage.textContent = allProducts.length
          ? `Showing ${allProducts.length} active products.`
          : "No active products found. Add some rows to your Products sheet.";
      } catch (err) {
        console.error("Error loading products:", err);
        statusMessage.textContent =
          "Could not load products from Google Sheets. Check that the sheet is published and accessible.";
        statusMessage.classList.add("error");
      }
    }

    function populateCategoryFilter(products) {
      const categories = new Set();
      products.forEach(p => {
        if (p.category) categories.add(p.category);
      });
      categoryFilter.innerHTML = '<option value="">All categories</option>';
      Array.from(categories)
        .sort()
        .forEach(cat => {
          const opt = document.createElement("option");
          opt.value = cat;
          opt.textContent = cat;
          categoryFilter.appendChild(opt);
        });
    }

    function renderProducts() {
      const categoryVal = categoryFilter.value.toLowerCase();
      const typeVal = typeFilter.value.toLowerCase();
      const searchVal = searchInput.value.trim().toLowerCase();

      const filtered = allProducts.filter(p => {
        const categoryMatch =
          !categoryVal || String(p.category || "").toLowerCase() === categoryVal;

        const typeMatch =
          !typeVal || String(p.product_type || "").toLowerCase() === typeVal.toLowerCase();

        const inName =
          String(p.product_name || "").toLowerCase().includes(searchVal) ||
          String(p.short_name || "").toLowerCase().includes(searchVal) ||
          String(p.product_id || "").toLowerCase().includes(searchVal);

        return categoryMatch && typeMatch && (!searchVal || inName);
      });

      productsGrid.innerHTML = "";

      if (!filtered.length) {
        productsGrid.innerHTML =
          '<div class="status-message">No products match your filters yet.</div>';
        statusMessage.textContent = "No products match current filters.";
        return;
      }

      statusMessage.textContent = `Showing ${filtered.length} product${
        filtered.length === 1 ? "" : "s"
      }.`;

      filtered.forEach(p => {
        const card = document.createElement("article");
        card.className = "product-card";

        // Image block
        const imgWrap = document.createElement("div");
        imgWrap.className = "product-image-wrap";

        const normalizedUrl = normalizeImageUrl(p.image_url);
        if (normalizedUrl) {
          const img = document.createElement("img");
          img.src = normalizedUrl;
          img.alt = p.short_name || p.product_name || "Product image";
          img.onerror = () => {
            imgWrap.textContent = "Product image not available";
          };
          imgWrap.appendChild(img);
        } else {
          imgWrap.textContent = "Product Image Placeholder";
        }

        // Title & meta
        const title = document.createElement("div");
        title.className = "product-title";
        title.textContent = p.short_name || p.product_name || "Untitled Product";

        const meta = document.createElement("div");
        meta.className = "product-meta";
        meta.textContent = [
          p.category || null,
          p.product_type ? `Type: ${p.product_type}` : null
        ]
          .filter(Boolean)
          .join(" · ");

        // Pricing + potential profit
        const priceRow = document.createElement("div");
        priceRow.className = "product-price-row";

        const left = document.createElement("div");
        const priceLabel = document.createElement("div");
        priceLabel.className = "product-price-label";
        priceLabel.textContent = "Reseller Price";

        const priceVal = document.createElement("div");
        priceVal.className = "product-price";

        const reseller = p.reseller_price_usd
          ? Number(p.reseller_price_usd)
          : null;
        priceVal.textContent = reseller != null && !isNaN(reseller)
          ? `$${reseller.toFixed(2)}`
          : "TBD";

        const shippingNote = document.createElement("div");
        shippingNote.className = "product-shipping-note";
        shippingNote.textContent = "US shipping included";

        left.appendChild(priceLabel);
        left.appendChild(priceVal);
        left.appendChild(shippingNote);

        // Potential profit block
        const profitBlock = document.createElement("div");
        profitBlock.className = "product-profit";

        const labelSpan = document.createElement("span");
        labelSpan.className = "label";
        labelSpan.textContent = "Potential Profit*";

        const valueSpan = document.createElement("span");

        const minProfit = p.est_profit_min_usd ? Number(p.est_profit_min_usd) : null;
        const maxProfit = p.est_profit_max_usd ? Number(p.est_profit_max_usd) : null;

        const minPrice = p.suggested_min_price_usd
          ? Number(p.suggested_min_price_usd)
          : null;
        const maxPrice = p.suggested_max_price_usd
          ? Number(p.suggested_max_price_usd)
          : null;

        let profitText = "";

        if (
          minProfit != null &&
          maxProfit != null &&
          !isNaN(minProfit) &&
          !isNaN(maxProfit)
        ) {
          profitText = `$${minProfit.toFixed(2)} – $${maxProfit.toFixed(2)}`;
        } else if (
          reseller != null &&
          !isNaN(reseller) &&
          minPrice != null &&
          maxPrice != null &&
          !isNaN(minPrice) &&
          !isNaN(maxPrice)
        ) {
          const minP = Math.max(0, minPrice - reseller);
          const maxP = Math.max(0, maxPrice - reseller);
          profitText = `$${minP.toFixed(2)} – $${maxP.toFixed(2)}`;
        } else {
          profitText = "TBD";
        }

        valueSpan.textContent = profitText;

        profitBlock.appendChild(labelSpan);
        profitBlock.appendChild(valueSpan);

        priceRow.appendChild(left);
        priceRow.appendChild(profitBlock);

        // Suggested eBay line
        const priceInfo = document.createElement("div");
        priceInfo.className = "product-price-info";
        if (
          minPrice != null &&
          maxPrice != null &&
          !isNaN(minPrice) &&
          !isNaN(maxPrice)
        ) {
          priceInfo.textContent = `Suggested eBay: $${minPrice.toFixed(2)}–$${maxPrice.toFixed(2)}`;
        }

        // Footer
        const footer = document.createElement("div");
        footer.className = "product-footer";

        const tagsWrap = document.createElement("div");
        tagsWrap.className = "product-tags";

        const isFeaturedStr = String(p.is_featured || "").toLowerCase().trim();
        if (isFeaturedStr === "true" || isFeaturedStr === "yes" || isFeaturedStr === "1") {
          const tag = document.createElement("span");
          tag.className = "product-tag";
          tag.textContent = "Featured";
          tagsWrap.appendChild(tag);
        }

        if (p.product_type) {
          const tag = document.createElement("span");
          tag.className = "product-tag";
          tag.textContent = p.product_type;
          tagsWrap.appendChild(tag);
        }

        const id = document.createElement("div");
        id.className = "product-id";
        if (p.product_id) {
          id.textContent = `ID: ${p.product_id}`;
        }

        footer.appendChild(tagsWrap);
        footer.appendChild(id);

        card.appendChild(imgWrap);
        card.appendChild(title);
        card.appendChild(meta);
        card.appendChild(priceRow);
        if (priceInfo.textContent) card.appendChild(priceInfo);
        card.appendChild(footer);

        productsGrid.appendChild(card);
      });
    }

    categoryFilter.addEventListener("change", renderProducts);
    typeFilter.addEventListener("change", renderProducts);
    searchInput.addEventListener("input", renderProducts);

    fetchProducts();
  </script>
</body>
</html>
